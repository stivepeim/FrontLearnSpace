<!DOCTYPE HTML>
<html>
<head>
    <style>
    ::cue(.loud) { font-size: 2em; color:Red;}
    ::cue(v[voice="Man"]) { color: green }

    .video_box{ position: relative; width:480px; height:320px; }
    .play_button{                                       /* 大号播放按钮 */
        position: absolute;
        top: 50%; left: 50%;
        margin: -25px 0 0 -25px;
        width: 50px; height: 50px;
        vertical-align: baseline;
        border: 1px solid #1a1b1a;
        cursor: pointer;
        -moz-border-radius: 5px;
        -webkit-border-radius: 5px;
        border-radius: 5px;
        background: transparent url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAAyCAIAAAASmSbdAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAADfSURBVHjaYvDy8gIIIKb///8DBBAIAwQQCAMEEAgDBBAIAwQQCAMEEAgDBBAIAwQQ03+G/wABBKIBAgiEAQIIhAECCIQBAgiEAQIIhAECCIQBAgiEAQKIieE/A0AAgWiAAAJhgABi+vf/H0AAgWiAAAKJAQQQiAYIIBAGCCAQBgggEAYIIBAGCCAQBgggEAYIIBAGCCAQBgggEAYIIJAdAAEEogECCIQBAgiEAQIIhAECCIQBAgiEAQIIhAECCIQBAgiEAQIIhAECCIQBAgiEAQIIhAECCIQBAgiEAQIMADV0jbLIoYBgAAAAAElFTkSuQmCC') repeat-x
    }
    .play_button:hover{
	    border: 1px solid #747474;
	    background: #747474;
	    background: transparent url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAAyCAIAAAASmSbdAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAADkSURBVHjaYrh16xZAADH9/fsXIICY/v37BxBAIAwQQCA2QACBaIAAAtEAAQSiAQIIhAECCMQGCCAQDRBAIBoggEA0QACBMEAAgdgAAQSiAQIIRAMEEIgGCCAQBgggpj9//gAEEAgDBBBIDCCAmH7//g0QQCAxgAAC8QECCIQBAggkBhBAIBoggEAYIIBAGCCAQHIAAQQSAwggEA0QQCAMEEAgNkAAgWiAAALRAAEEogECCIQBAgjEBgggEA0QQCAaIIBANEAAgTBAAIHYAAEEogECCEQDBBCIBgggEAYIIBAbIMAA0hOUZfQjygYAAAAASUVORK5CYII=') repeat-x;
    }
    .play_button div{                               /* 大号播放按钮三角箭头 */
        margin: 13px 0 0 14px; padding: 0;
        height: 0; width: 0;
        font-size: 0px;
        line-height: 0%;
        border-top: 12px solid transparent;
        border-left: 24px solid #fff;
        border-bottom: 12px solid transparent;
    }
    .play_controls{                                 /* 播放工具条外框 */
        position: absolute; top: auto; bottom: -5px; height: 29px; cursor: default; width:100%;
	    border-top: 1px solid #000;
	    -moz-user-select: -moz-none;
	    -khtml-user-select: none;
	    -webkit-user-select: none;
	    -o-user-select: none;
	    user-select: none;
	    background: #646464;
	    background: transparent url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAAeCAIAAABi9+OQAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAACbSURBVHjaYvDwcAcIIGZOLk6AAGL68eMHQAAxAQFAADH9//8fIICYGBgYAAIIiP8DBBDTv3//AAIIxAcIIBAGCCAQBgggEAYIIBAGCCAQBgggEAYIIJA8QAAx/Wf4DxBATP///gcIIBAfIICAbAaAAAKJAQQQSD9AAIH4AAEEwgABBGIDBBCIBgggEAYIIBAGCCAQBgggEAYIMAB1v0PS0+tkpgAAAABJRU5ErkJggg==') repeat-x;
    }
    .control{                                       /* 播放按钮共用样式 */
        cursor: pointer; float: left; text-align: center; 
        margin: 0; padding: 0;
        width: 32px; height: 28px;
    }
    .play_control{ }
    .play_control div{
        margin: 8px 0 0 8px;
        font-size: 0px;
        line-height: 0%;
        cursor: pointer;
        width: 17px; height: 18px;
        background: transparent url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA0AAAAPCAYAAAA/I0V3AAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAEKSURBVHjaYpgxY8b+////M5CCAQKI8fr16/8/f/7M8P3790Y7O7sGBiIAQAAxXrt27T+M8+XLF6I0AwQQiiZiNQMEEOOFCxf+4zLx169fWDUDBBDjmdNn/hPyw7///1A0AwQQ4+HDh/8zEAnY2dnBmgECiAVIEKsHpIHhypUr9QABxPL502eiNa1Zu4bh7LlTDAABxPLp8yeCinft2gVWfOvmXVDkMgIEEMvHjx9xKj558iSKYpg4QACxgOIEHVy9epXh9JlTDHduoyqGAYAAYvn27Rucc//+fYbzF84x3Lh+E6tiGAAIILCmly9fMly+conhyuWreBXDAEAAMaipK4Pi6T8pqRwgwABM+9n3+5s7rgAAAABJRU5ErkJggg==') no-repeat;
    }
    .pause_control{ }
    .pause_control div{                             /* 暂停按钮样式 */
        height: 13px; width: 5px; float: left;
	    border-right: 1px solid #000; border-bottom: 1px solid #000;
	    background: #f1f1f1;
	    background: transparent url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAANCAIAAADntZOlAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAABNSURBVHjaYjh+/DhAADH9+vULIIBAGCCAQBgggJh+/vwJEEBM379/BwggEAYIIBAGCCAQBgggph8/fgAEEEgOIICYfv/+DRBAIBogwAC/IyVsa3L9ogAAAABJRU5ErkJggg==') repeat-x;
    }
    .pause_control div:nth-child(1) { margin: 9px 0 0 5px; }
    .pause_control div:nth-child(2) { margin: 9px 0 0 2px; }
    .fullscreen_control{ float:right; }
    .fullscreen_control div{                         /* 全屏按钮样式 */
        border: 1px solid #f1f1f1;
        margin: 11px 0 0 6px; height: 7px; width: 14px;
	    background: #7a7a7a;
	    background: transparent url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAANCAIAAADntZOlAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAABNSURBVHjaYti9ezdAADH9+vULIICYfv78CRBATN+/fwcIIBAGCCAQBgggEAYIIKYfP34ABBBIDiCAmH7//g0QQCAaIIBAGCCAQBggwAC2yyVIH487bgAAAABJRU5ErkJggg==') repeat-x;
    }
    .fullscreen_control div:hover{
        margin: 9px 0 0 4px; height: 11px; width: 20px; 
	    background: #2b5880;
	    background: transparent url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAALCAIAAAAx7HC4AAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAABJSURBVHjaYnCYcBMggJj+/vkBEEBMf/78AQggJqY/vwECCEQDBBATw+8vAAHE9O/fP4AAYmL89Q0ggEA0QAAB+V8BAggkDhBgAEoNG0hmL6RlAAAAAElFTkSuQmCC') repeat-x;
    }
    .timer_control{ width: 120px; cursor: default; }
    .timer_control div{                             /* 时间显示区域样式 */
        margin: 9px 0 0; 
        font: 10px/1.231 "bitstream vera sans", "lucida grande", verdana !important;
        text-align: center;
        text-shadow: 1px 1px 1px rgba(0,0,0,1);
        -moz-text-shadow: 1px 1px 1px rgba(0,0,0,1);
        -webkit-text-shadow: 1px 1px 1px rgba(0,0,0,1);
	    -o-text-shadow: 1px 1px 1px rgba(0,0,0,1);
        color: #fff;
    }
    .progress_control{                              /* 进度条样式 */
        height: 11px;
        margin: 9px 0 0;
        background: #272826;
    }
    .progress_bar_bg {
	    position: absolute; height: 11px; cursor: pointer; z-Index: 3;
        border-style: solid; border-width: 1px; border-color: #f1f1f1 #c1c1c1 #c1c1c1 #f1f1f1;
    }
    .progress_bar_buffered {                        /* 下载进度条 */
	    position: absolute; height: 11px; cursor: pointer; z-index:1;top: 10px;margin-left: 1px;
	    background: #666666;
	    background: transparent url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAALCAIAAAAx7HC4AAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAABFSURBVHjaYjh48CBAADH9+vULIIBAGCCAmH7+/AkQQEzfv38HCCAQBgggEAYIIBAGCCCmHz9+AAQQSA4ggJh+//4NEGAAp5AfekadfZoAAAAASUVORK5CYII=') repeat-x;
    }
    .progress_bar_played {                          /* 播放进度条 */
	    position: absolute; height: 11px; cursor: pointer;z-index:2;top: 10px;margin-left: 1px;
	    background: #f1f1f1;
	    background: transparent url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAALCAIAAAAx7HC4AAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAABJSURBVHjaYnCYcBMggJj+/vkBEEBMf/78AQggJqY/vwECCEQDBBATw+8vAAHE9O/fP4AAYmL89Q0ggEA0QAAB+V8BAggkDhBgAEoNG0hmL6RlAAAAAElFTkSuQmCC') repeat-x;
    }
    .progress_bar_time{
        	position: absolute; height: 8px; border: 1px solid transparent; background: transparent; z-Index: 3; display:none;
    }
    .progress_bar_time_line {
	    position: absolute; top: -13px;  width: 0; height: 0; cursor: pointer; left:15px;
	    font-size: 0px; line-height: 0%;
	    border-top: 10px solid #f1f1f1; border-bottom: 10px solid transparent; border-left: 10px solid transparent; border-right: 10px solid transparent;
    }
    .progress_bar_time_txt {
	    position: absolute; top: -35px; padding: 4px 5px; height: 12px;
	    color: #f1f1f1; border: 1px solid #f1f1f1; font: 9px/1.231 "bitstream vera sans", "lucida grande", verdana ; text-shadow: 1px 1px 1px rgba(0,0,0,1);
	    background: #7a7a7a;
	    background: transparent url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAIAAAAZCAIAAACUxWgrAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAWUlEQVQImTWNwQnEQBDDZHCzW3PSSGB3dI/kXgZh2VlrAb3vC+g+G+nMIHUUe+aE/OHMhHTvt3mGvAL0eZ4vklR0LAJ0fDcVKSJ2nJACatXvKKSI8ROSBPgBKfBOodJK2ZEAAAAASUVORK5CYII=') repeat-x;
    }
    .backward_control{ width:25px; margin-left:5px;}
    .backward_control div:nth-child(2){
        margin:4px 0 0 0px; font-size: 0px; line-height: 0%; cursor: pointer; height: 18px; width:13px; float: left;
        transform:rotate(-180deg);-moz-transform:rotate(-180deg); -webkit-transform:rotate(-180deg);
        background: transparent url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA0AAAAPCAYAAAA/I0V3AAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAEKSURBVHjaYpgxY8b+////M5CCAQKI8fr16/8/f/7M8P3790Y7O7sGBiIAQAAxXrt27T+M8+XLF6I0AwQQiiZiNQMEEOOFCxf+4zLx169fWDUDBBDjmdNn/hPyw7///1A0AwQQ4+HDh/8zEAnY2dnBmgECiAVIEKsHpIHhypUr9QABxPL502eiNa1Zu4bh7LlTDAABxPLp8yeCinft2gVWfOvmXVDkMgIEEMvHjx9xKj558iSKYpg4QACxgOIEHVy9epXh9JlTDHduoyqGAYAAYvn27Rucc//+fYbzF84x3Lh+E6tiGAAIILCmly9fMly+conhyuWreBXDAEAAMaipK4Pi6T8pqRwgwABM+9n3+5s7rgAAAABJRU5ErkJggg==') no-repeat;
    }
    .backward_control div:nth-child(1){
        margin:8px 0 0 0px; height: 13px; width: 4px; float: left;
	    border-right: 1px solid #000; border-bottom: 1px solid #000;
	    background: #f1f1f1;
	    background: transparent url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAANCAIAAADntZOlAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAABNSURBVHjaYjh+/DhAADH9+vULIIBAGCCAQBgggJh+/vwJEEBM379/BwggEAYIIBAGCCAQBgggph8/fgAEEEgOIICYfv/+DRBAIBogwAC/IyVsa3L9ogAAAABJRU5ErkJggg==') repeat-x;
    }
    .forward_control{ width:25px; }
    .forward_control div:nth-child(1){
        margin:8px 0 0 1px; font-size: 0px; line-height: 0%; cursor: pointer; height: 18px; width:13px; float: left;
        background: transparent url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA0AAAAPCAYAAAA/I0V3AAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAEKSURBVHjaYpgxY8b+////M5CCAQKI8fr16/8/f/7M8P3790Y7O7sGBiIAQAAxXrt27T+M8+XLF6I0AwQQiiZiNQMEEOOFCxf+4zLx169fWDUDBBDjmdNn/hPyw7///1A0AwQQ4+HDh/8zEAnY2dnBmgECiAVIEKsHpIHhypUr9QABxPL502eiNa1Zu4bh7LlTDAABxPLp8yeCinft2gVWfOvmXVDkMgIEEMvHjx9xKj558iSKYpg4QACxgOIEHVy9epXh9JlTDHduoyqGAYAAYvn27Rucc//+fYbzF84x3Lh+E6tiGAAIILCmly9fMly+conhyuWreBXDAEAAMaipK4Pi6T8pqRwgwABM+9n3+5s7rgAAAABJRU5ErkJggg==') no-repeat;
    }
    .forward_control div:nth-child(2){
        height: 13px; width: 4px; float: left; margin: 8px 0 0 1px;
	    border-right: 1px solid #000; border-bottom: 1px solid #000;
	    background: #f1f1f1;
	    background: transparent url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAANCAIAAADntZOlAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAABNSURBVHjaYjh+/DhAADH9+vULIIBAGCCAQBgggJh+/vwJEEBM379/BwggEAYIIBAGCCAQBgggph8/fgAEEEgOIICYfv/+DRBAIBogwAC/IyVsa3L9ogAAAABJRU5ErkJggg==') repeat-x;
    
    }
    .fullscreen {height:100%; width:100%;}          /* 全屏效果样式 */
    </style>
    <script src="../js/jquery-1.8.3.js"></script>
</head>
<body>
    <header><h2>处理带字幕的视频</h2></header>
    <div class="video_box">
        <video width="480" height="320" controls poster="../images/BigBuck.png" preload="none">
            <source src="../res/BigBuck.webm" type="video/mp4">
            <track label="English subtitles" kind="captions" srclang="en" src="../res/BigBuck.vtt" default>
        </video>
    </div>
</body>
<script>
    (function () {
        // 播放工具条
        var CONTROLS_HTML = '<div class="play_button" title="播放" data-type="go"><div></div></div>' +
                            '<div class="play_controls" style="display:none">' +
                                '<div class="control backward_control" data-type="backward" title="慢退"><div></div><div></div></div>' +
                                '<div class="control play_control control_btn" data-type="play" title="播放" style="display:none"><div></div></div>' +
                                '<div class="control pause_control control_btn" data-type="pause" title="暂停"><div></div><div></div></div>' +
                                '<div class="control forward_control" data-type="forward" title="快进"><div></div><div></div></div>' +
                                '<div class="control progress_control">' +
                                    '<div class="progress_bar_bg"></div>' +
                                    '<div class="progress_bar_buffered"></div>' +
                                    '<div class="progress_bar_played"></div>' +
                                    '<div class="progress_bar_time">' +
                                        '<div class="progress_bar_time_line"></div>' +
                                        '<div class="progress_bar_time_txt">00:00</div>' +
                                    '</div>' +
                                '</div>' +
                                '<div class="control timer_control"><div><span class="J_currentTime">00:00</span> / <span class="J_duration">00:00</span></div></div>' +
                                '<div class="control fullscreen_control" title="全屏" data-type="fullscreen"><div></div></div>' +
                            '</div>';
        var DOC = $(document);

        function timeFormat(seconds) {
            var min = Math.floor(seconds / 60), second = Math.floor(seconds - (min * 60));
            return (min < 10 ? '0' + min : min) + ":" + (second < 10 ? '0' + second : second);
        };

        function VideoControl(ele) {                            // 播放工具条类
            this.prefix = 'Webkit Moz O ms Khtml '.split(' ');
            this.video = $(ele);
            this.init();
        };
        VideoControl.prototype = {                              // 原型方法
            init: function () {
                // 移除video原本的controls属性，去除浏览器默认工具条
                this.video.removeAttr('controls');
                this._render();
                this._bind();
                this._timeupdate();
                this._progress();
                this._bartime();
            },
            _render: function () {                              // 用于生成工具条html结构
                var wraper = this.wraper = $(document.createElement('div'));
                wraper.html(CONTROLS_HTML);
                this.video.parent().append(wraper);             // 将工具类插入文档
            },
            _bind: function () {                                // 给工具条的元素绑定事件
                var self = this,
                    video = self.video.get(0),                  // 获取对应的原生元素
                    wraper = self.wraper,
                    control_btn = wraper.find('div.control_btn'),
                    fullscreen_btn = wraper.find('div.fullscreen_control');

                // 用jQuery的delegate方法委托特制元素监听click事件
                wraper.delegate('div[data-type]', 'click', function (e) {
                    var target = $(this),
                        data_type = target.attr('data-type');  // 获取按钮自定义操作类型属性
                    switch (data_type) {
                        case 'go':                              // 初始屏中间大按钮
                            wraper.find('div.play_button').hide();
                            wraper.find('div.play_controls').show();
                            video.play();                       // 播放视频 
                            self._resizeProgressBar();
                            break;
                        case 'play':                            // 自定义工具条播放键
                            control_btn.toggle();
                            video.play();
                            break;
                        case 'pause':                           // 自定义工具条暂停键
                            control_btn.toggle();               // 暂停视频
                            video.pause();
                            break;
                        case 'fullscreen':                      // 自定义工具条全屏键
                            self._requestFullscreen(video, target);
                            break;
                        case 'exitfullscreen':                  // 自定义工具条退出全屏
                            self._exitFullscreen(video, target);
                            break;
                        case 'backward':                        // 自定义工具条慢退
                            self._playbackRate(-0.1);
                            break;
                        case 'forward':                         // 自定义工具条快进
                            self._playbackRate(0.1);
                            break;
                    };
                });

                DOC.on({
                    "fullscreenchange": function () {
                        if (!document.fullscreen) {
                            self._exitFullscreen(video, fullscreen_btn);
                        };
                    },
                    "mozfullscreenchange": function () {
                        if (!document.mozFullScreen) {
                            self._exitFullscreen(video, fullscreen_btn);
                        };
                    },
                    "webkitfullscreenchange": function () {
                        if (!document.webkitIsFullScreen) {
                            self._exitFullscreen(video, fullscreen_btn);
                        };
                    }
                });
            },
            _timeupdate: function () {
                var self = this,
                    currentTime = self.wraper.find('span.J_currentTime'),
                    duration = self.wraper.find('span.J_duration'),
                    progress_bar = self.wraper.find('div.progress_control'),
                    progress_bar_played = self.wraper.find('div.progress_bar_played'),
                    video = self.video.get(0);

                this.video.on({
                    'timeupdate': function () {
                        currentTime.html(timeFormat(video.currentTime));
                        var percent = video.currentTime / video.duration;
                        progress_bar_played.width(percent * progress_bar.width());
                    },
                    'loadedmetadata': function () {
                        duration.html(timeFormat(video.duration));
                    }
                });
            },
            _requestFullscreen: function (video, target) {                     // 全屏方法
                // 各种浏览器全屏方法前缀
                var prefixs = this.prefix,                                      // 各种浏览器全屏方法前缀
                    parent = video.parentNode,
                    prefix;
                // 循环各浏览器前缀名，找寻符合的方法并执行
                for (var i = 0, l = prefixs.length; i < l; i++) {
                    prefix = prefixs[i].toLowerCase();

                    if (parent[prefix + 'EnterFullScreen']) {                   //兼容不同浏览器全屏方法 
                        parent[prefix + 'EnterFullScreen']();
                        break;
                    } else if (parent[prefix + 'RequestFullScreen']) {
                        parent[prefix + 'RequestFullScreen']();
                        break;
                    };
                };

                $(video).addClass('fullscreen');
                $(parent).addClass('fullscreen');
                target.attr('data-type', 'exitfullscreen');
                this._resizeProgressBar();
            },
            _exitFullscreen: function (video, target) {
                var prefixs = this.prefix,
                    parent = video.parentNode,
                    prefix;
                // 循环各浏览器前缀名，找寻符合的方法并执行
                for (var i = 0, l = prefixs.length; i < l; i++) {
                    prefix = prefixs[i].toLowerCase();

                    if (document[prefix + 'exitFullscreen']) {   //兼容不同浏览器全屏方法 
                        document[prefix + 'exitFullscreen']();
                        break;
                    } else if (document[prefix + 'CancelFullScreen']) {
                        document[prefix + 'CancelFullScreen']();
                        break;
                    };
                };

                $(video).removeClass('fullscreen');
                $(parent).removeClass('fullscreen');
                target.attr('data-type', 'fullscreen');
                this._resizeProgressBar();
            },
            _resizeProgressBar: function () {                   // 调整进度条宽度
                var wraper = this.wraper,
                    width = this.video.outerWidth(false) -
                           wraper.find('div.play_control').outerWidth(true) -
                           wraper.find('div.timer_control').outerWidth(true) -
                           wraper.find('div.fullscreen_control').outerWidth(true) - 55;

                wraper.find('div.progress_control').css('width', width);
                wraper.find('div.progress_bar_bg').css('width', width);
            },
            _progress: function () {
                var self = this,
                    video = self.video,
                    video_ele = video.get(0),
                    progress_bar = self.wraper.find('div.progress_control'),
                    progress_bar_buffered = self.wraper.find('div.progress_bar_buffered');
                video.on({
                    'progress': function (e) {
                        var self = this;
                        setTimeout(function () {
                            if (self.buffered && self.buffered.length) {
                                var percent = video_ele.buffered.end(0) / video_ele.duration;
                                progress_bar_buffered.width(percent * progress_bar.width());
                            };
                        }, 50);
                    }
                });
            },
            _bartime: function () {
                var wraper = this.wraper,
                    progress_control = wraper.find('div.progress_control'),
                    progress_bar_bg = wraper.find('div.progress_bar_bg'),
                    progress_bar_time = wraper.find('div.progress_bar_time'),
                    progress_bar_time_txt = wraper.find('div.progress_bar_time_txt'),
                    video_ele = this.video.get(0);
                progress_bar_bg.on({
                    'mousemove': function (e) {
                        var offsetX = e.clientX - progress_bar_bg.offset().left,
                            percent = offsetX / progress_bar_bg.width();
                        progress_bar_time.css('left', offsetX + 60);
                        progress_bar_time_txt.html(timeFormat((percent * video_ele.duration) || 0));
                    },
                    'mouseenter': function () { progress_bar_time.show(); },
                    'mouseleave': function () { progress_bar_time.hide(); }
                });
            },
            _playbackRate: function (rate) {
                this.video.get(0).playbackRate += rate;
            }
        };
        new VideoControl(document.querySelector('video'));      // 实例化自定义工具条类
    })();   
</script>
</html>
