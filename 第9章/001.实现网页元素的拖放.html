<!doctype html>
<html>
<head>
    <style>
    .garbage{ width:120px; height:135px; position: relative; }  /* 垃圾桶样式类 */
    .garbage i{                                                 /* 垃圾桶纸团计数 */
       position: absolute; top: 61px; left: 46px;
       font-weight:bold; color:red;
    }
    .empty{ background:url(../images/garbage-e.png) no-repeat; }/* 空垃圾桶 */
    .full{ background:url(../images/garbage-f.png) no-repeat; } /* 满垃圾桶 */
    .paper{                                                     /* 纸团样式类 */
        background:url(../images/paper.png) no-repeat;float:left;
        width:64px; height:57px; cursor:move; position: relative; 
    }
    .paper i{                                                   /* 纸团编号 */
       position: absolute; top: 18px;  left: 23px;
       font-weight:bold; color:black;
    }
    .line_3d{                                                   /* 垃圾桶摇摆样式类 */
        -webkit-animation-name:shake;
        -webkit-animation-duration:1s;
    }
    @-webkit-keyframes shake{                                   /* 定义投放垃圾动画名 */
        from{-webkit-transform:rotate(0deg);}
        20%{-webkit-transform:rotate(20deg);}
        60%{-webkit-transform:rotate(-20deg);}
        to{-webkit-transform:rotate(0deg);}
    }
    </style>
</head>
<body>
    <header><h2>实现网页元素的拖放</h2></header>
    <section>
        <!-- 垃圾桶 -->
        <div class="garbage empty"><i>0</i></div>
        <!-- 垃圾丢放音频 -->
        <audio src="../res/garbage.mp3">您的浏览器不支持audio标签</audio>
    </section>
    <section>
        <!-- 3个纸团 -->
        <div class="paper" draggable="true"><i>1</i></div>
        <div class="paper" draggable="true"><i>2</i></div>
        <div class="paper" draggable="true"><i>3</i></div>
    </section>
</body>
<script>
    (function () {
        var slice = Array.prototype.slice,
            audio = document.querySelector('audio'),                // 垃圾投放音频
            // 将3个纸团对应的元素转为数组
            papers = slice.call(document.querySelectorAll('div.paper'), 0),
            garbage = document.querySelector('div.empty'),          // 空垃圾箱
            num = garbage.querySelector('i'),                       // 垃圾箱计数
            current_paper;
        papers.forEach(function (paper) {
            paper.addEventListener('dragstart', function (e) {      // 监听纸团拖动开始事件
                current_paper = paper;                              // 设置被拖动的纸团于闭包变量中
            }, false);
        });
        garbage.addEventListener('dragover', function (e) {         // 鼠标拖拽在该元素上移动时触发
            e.preventDefault();                                     // 阻止浏览器元素默认时间
        }, false);
        garbage.addEventListener('drop', function (e) {             // 监听垃圾桶投放事件
            audio.play();                                           // 播放垃圾投放音频
            garbage.className += ' line_3d';                        // 添加CSS 3 摇摆动画
            setTimeout(function () {                                // 过1秒自动移除动画样式
                garbage.className = garbage.className.replace(/ line_3d/g, '');
            }, 1000);
            if (!/full/g.test(garbage.className)) {                 // 判断是否为有垃圾状态
                garbage.className += ' full';                       // 将垃圾桶置为填满状态
            };
            num.innerHTML = parseInt(num.innerHTML) + 1;            // 垃圾桶计数加一
            current_paper.remove();                                 // 移除当前拖动的纸团
        }, false);
    })();
</script>
</html>
